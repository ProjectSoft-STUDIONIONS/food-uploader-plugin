!function(e){"object"==typeof jQuery.fancybox&&(jQuery.fancybox.defaults.transitionEffect="circular",jQuery.fancybox.defaults.transitionDuration=500,jQuery.fancybox.defaults.lang="ru",jQuery.fancybox.defaults.i18n.ru={CLOSE:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",NEXT:"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439",PREV:"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0439",ERROR:"\u0417\u0430\u043f\u0440\u043e\u0448\u0435\u043d\u043d\u044b\u0439 \u043a\u043e\u043d\u0442\u0435\u043d\u0442 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d.<br/>\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u043e\u043f\u044b\u0442\u043a\u0443 \u043f\u043e\u0437\u0436\u0435.",PLAY_START:"\u041d\u0430\u0447\u0430\u0442\u044c \u0441\u043b\u0430\u0439\u0434\u0448\u043e\u0443",PLAY_STOP:"\u041e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u043b\u0430\u0439\u0434\u0448\u043e\u0443",FULL_SCREEN:"\u041f\u043e\u043b\u043d\u044b\u0439 \u044d\u043a\u0440\u0430\u043d",THUMBS:"\u041c\u0438\u043d\u0438\u0430\u0442\u044e\u0440\u044b",DOWNLOAD:"\u0421\u043a\u0430\u0447\u0430\u0442\u044c",SHARE:"\u041f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f",ZOOM:"\u0423\u0432\u0435\u043b\u0438\u0447\u0438\u0442\u044c"});let t=location.search.replace(/\?/g,"").split("&").map((e,t,a)=>{return e.split("=")});const a=Object.fromEntries(t);if(jQuery(document).on("input","#uploader [type=file]",e=>{let t=document.querySelector("#uploader [type=file]"),a=jQuery("#p_uploads"),o=parseInt(t.getAttribute("data-max")),n=[];[...t.files].length>o&&(alert(`\u0412\u044b \u043d\u0435 \u043c\u043e\u0436\u0435\u0442\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 ${o} \u0444\u0430\u0439\u043b(a/\u043e\u0432).`),document.upload_food.reset());for(let e of[...t.files]){let t;if(null!==(t=/[^.]+$/.exec(e.name))){let o=t[0].toLowerCase();if("xlsx"!=o&&"pdf"!=o)return a.html(""),alert("\u041d\u0435\u043b\u044c\u0437\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0439 \u0442\u0438\u043f \u0444\u0430\u0439\u043b\u0430!\n\n"+e.type+"\n\n"),document.upload_food.reset(),!1;n.push(e.name)}}a.html(n.join("<br>"))}).on("click","a.food-link",e=>{e.preventDefault();window.location.origin;let t=e.target.href,a=t.split(".").at(-1).toLowerCase();return"object"==typeof jQuery.fancybox?(options={src:window.location.origin+"/viewer/pdf_viewer/?file="+t,opts:{afterShow:function(e,t){jQuery(".fancybox-content").css({height:"100% !important",overflow:"hidden"}).addClass(`${a}_viewer`)},afterLoad:function(e,t){jQuery(".fancybox-content").css({height:"100% !important",overflow:"hidden"}).addClass(`${a}_viewer`)},afterClose:function(){Cookies.remove("pdfjs.history",{path:""}),window.localStorage.removeItem("pdfjs.history")}}},jQuery.fancybox.open(options)):window.open(t),!1}).on("click",".food-rename, .food-delete",function(e){e.preventDefault();let t,a=e.target,o=document.querySelector("form[name=form_mode]"),n=o.querySelector("input[name=mode]"),r=o.querySelector("input[name=new_file]"),i=o.querySelector("input[name=file]");if(a.classList.contains("food-rename")){const e=(t=jQuery(a).data("file")).split("."),l=e.pop();let s=e.join("."),u=prompt("\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u043d\u043e\u0432\u043e\u0435 \u0438\u043c\u044f \u0434\u043b\u044f \u0444\u0430\u0439\u043b\u0430:",s);if(!u)return!1;if(u==e.join("."))return!1;i.value=t,r.value=u+`.${l}`,n.value="rename",jQuery(o).submit()}return!!a.classList.contains("food-delete")&&(t=jQuery(a).data("file"),!!confirm(`\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0444\u0430\u0439\u043b ${t}?`)&&(n.value="delete",i.value=t,jQuery(o).submit(),!1))}),a.dir){DataTable.Buttons.defaults.dom.button.liner.tag="",DataTable.Buttons.defaults.dom.button.className="dt-button btn btn-default",DataTable.Buttons.defaults.dom.container.className=DataTable.Buttons.defaults.dom.container.className+" btn-group",DataTable.ext.buttons.pdfHtml5.className=DataTable.ext.buttons.pdfHtml5.className+" btn btn-secondary",DataTable.ext.buttons.excelHtml5.className=DataTable.ext.buttons.excelHtml5.className+" btn btn-secondary",DataTable.ext.classes.layout.start="dt-layout-start col-lg-6",DataTable.ext.classes.layout.end="dt-layout-end col-lg-6";location.origin,a.dir;jQuery(".table").DataTable({columns:[{name:"file"},{name:"permission"},{name:"date"},{name:"size"},{name:"actions"}],columnDefs:[{searchable:!0,targets:[0],orderable:!0},{searchable:!1,targets:[1,2,3,4],orderable:!1}],ordering:!0,stateSave:!0,stateSaveCallback:function(e,t){localStorage.setItem("DataTables_"+e.sInstance+"_"+a.dir,JSON.stringify(t))},stateLoadCallback:function(e){return JSON.parse(localStorage.getItem("DataTables_"+e.sInstance+"_"+a.dir))},lengthMenu:[[10,25,50,100,-1],["\u043f\u043e 10","\u043f\u043e 25","\u043f\u043e 50","\u043f\u043e 100","\u0412\u0441\u0435"]],layout:{topStart:{buttons:[{extend:"colvis",className:"button-colvis btn btn-primary",text:'<i class="glyphicon glyphicon-tasks"></i>\u0412\u0438\u0434\u0438\u043c\u043e\u0441\u0442\u044c \u0441\u0442\u043e\u043b\u0431\u0446\u043e\u0432',attr:{title:"\u0412\u0438\u0434\u0438\u043c\u043e\u0441\u0442\u044c \u0441\u0442\u043e\u043b\u0431\u0446\u043e\u0432\r\n\u0412\u043b\u0438\u044f\u0435\u0442 \u043d\u0430 \u041f\u0435\u0447\u0430\u0442\u044c"},columns:[1,2,3,4],select:!0},{extend:"print",className:"button-print btn btn-success",text:'<i class="glyphicon glyphicon-print"></i>\u041f\u0435\u0447\u0430\u0442\u044c',attr:{title:"\u0412\u044b\u0432\u0435\u0441\u0442\u0438 \u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0430 \u041f\u0435\u0447\u0430\u0442\u044c"},exportOptions:{columns:[":visible"]},messageTop:document.title,messageBottom:!1,header:!0,footer:!0,title:"",autoPrint:!0}],pageLength:"pageLength",search:"search"},topEnd:{buttons:[{text:'<i class="glyphicon glyphicon-floppy-save"></i>\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0444\u0430\u0439\u043b\u044b \u0434\u043b\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438',className:"button-upload btn btn-success",action:function(e,t,a,o){let n,r;(n=document.querySelector("#uploader"))&&(r=n.querySelector("[type=file]"))&&r.click()}}]}},language:{url:"/wp-content/plugins/food-uploader-plugin/js/ru_RU.json"}})}else jQuery(".food-row").addClass("row-disabled");jQuery(".food-row").removeClass("hidden"),jQuery("body").on("thickbox:removed",function(){}),window.tb_position=function(){var e=jQuery(window).width(),t=jQuery(window).height()-70,a=792<e?772:e-60;let o=jQuery("#TB_window");o.length&&(o.width(a),jQuery("#TB_iframeContent").width(a).css({position:"relative",height:"calc(100% - 30px)"}),o.css({"margin-left":"-"+parseInt(a/2,10)+"px",overflow:"hidden","margin-top":"calc(35px - 50vh)"})),jQuery("a.thickbox").each(function(){var e=jQuery(this).attr("href");e&&(e=(e=e.replace(/&width=[0-9]+/g,"")).replace(/&height=[0-9]+/g,""),jQuery(this).attr("href",e+"&width="+a+"&height="+t))})},window.tb_position(),jQuery(document).on("thickbox:iframe:loaded",function(e){jQuery(window).trigger("resize");jQuery("#TB_window").addClass("plugin-food-settings-modal").attr({role:"dialog","aria-label":"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \xab\u041c\u0435\u043d\u044e \u0435\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u043e\u0433\u043e \u043f\u0438\u0442\u0430\u043d\u0438\u044f\xbb"}),jQuery("#TB_window").find("#TB_ajaxWindowTitle").html('<i class="dashicons dashicons-admin-generic"></i>&nbsp;\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \xab\u041c\u0435\u043d\u044e \u0435\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u043e\u0433\u043e \u043f\u0438\u0442\u0430\u043d\u0438\u044f\xbb'),jQuery(window).trigger("resize")}),jQuery(window).on("resize",window.tb_position).trigger("resize")}(jQuery);